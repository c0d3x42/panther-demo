import{J as N,R as ae,A as W,B as de,o as a,c as u,g as b,G as J,E as T,H as v,z as k,I as re,v as _,l as V,t as M,D as Q,C as A,O as ce,ac as ue,d as I,a5 as he,ad as O,e as x,h as c,f as y,Q as B,r as P,a3 as z,j as $,a1 as F,a2 as U,P as G,aa as q,a0 as j,ae as pe,af as fe,ag as L}from"./index-ce3b542e.js";import{c as me,e as X,d as Y,s as Z,b as ee,a as le}from"./panel.esm-6cdf540e.js";import{s as te}from"./splitbutton.esm-03c85bc7.js";import{s as ge}from"./divider.esm-e9beee8a.js";var ne={name:"TreeNode",emits:["node-toggle","node-click","checkbox-change"],props:{node:{type:null,default:null},expandedKeys:{type:null,default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},templates:{type:null,default:null},level:{type:Number,default:null},index:{type:Number,default:null}},nodeTouched:!1,mounted(){this.$refs.currentNode.closest(".p-treeselect-items-wrapper")&&this.setAllNodesTabIndexes()},methods:{toggle(){this.$emit("node-toggle",this.node)},label(l){return typeof l.label=="function"?l.label():l.label},onChildNodeToggle(l){this.$emit("node-toggle",l)},onClick(l){N.hasClass(l.target,"p-tree-toggler")||N.hasClass(l.target.parentElement,"p-tree-toggler")||(this.isCheckboxSelectionMode()?this.toggleCheckbox():this.$emit("node-click",{originalEvent:l,nodeTouched:this.nodeTouched,node:this.node}),this.nodeTouched=!1)},onChildNodeClick(l){this.$emit("node-click",l)},onTouchEnd(){this.nodeTouched=!0},onKeyDown(l){if(this.isSameNode(l))switch(l.code){case"Tab":this.onTabKey(l);break;case"ArrowDown":this.onArrowDown(l);break;case"ArrowUp":this.onArrowUp(l);break;case"ArrowRight":this.onArrowRight(l);break;case"ArrowLeft":this.onArrowLeft(l);break;case"Enter":case"Space":this.onEnterKey(l);break}},onArrowDown(l){const t=l.target,e=t.children[1];if(e)this.focusRowChange(t,e.children[0]);else if(t.nextElementSibling)this.focusRowChange(t,t.nextElementSibling);else{let i=this.findNextSiblingOfAncestor(t);i&&this.focusRowChange(t,i)}l.preventDefault()},onArrowUp(l){const t=l.target;if(t.previousElementSibling)this.focusRowChange(t,t.previousElementSibling,this.findLastVisibleDescendant(t.previousElementSibling));else{let e=this.getParentNodeElement(t);e&&this.focusRowChange(t,e)}l.preventDefault()},onArrowRight(l){this.leaf||this.expanded||(l.currentTarget.tabIndex=-1,this.$emit("node-toggle",this.node),this.$nextTick(()=>{this.onArrowDown(l)}))},onArrowLeft(l){const t=N.findSingle(l.currentTarget,".p-tree-toggler");if(this.level===0&&!this.expanded)return!1;if(this.expanded&&!this.leaf)return t.click(),!1;const e=this.findBeforeClickableNode(l.currentTarget);e&&this.focusRowChange(l.currentTarget,e)},onEnterKey(l){this.setTabIndexForSelectionMode(l,this.nodeTouched),this.onClick(l),l.preventDefault()},onTabKey(){this.setAllNodesTabIndexes()},setAllNodesTabIndexes(){const l=N.find(this.$refs.currentNode.closest(".p-tree-container"),".p-treenode"),t=[...l].some(e=>e.getAttribute("aria-selected")==="true"||e.getAttribute("aria-checked")==="true");if([...l].forEach(e=>{e.tabIndex=-1}),t){const e=[...l].filter(i=>i.getAttribute("aria-selected")==="true"||i.getAttribute("aria-checked")==="true");e[0].tabIndex=0;return}[...l][0].tabIndex=0},setTabIndexForSelectionMode(l,t){if(this.selectionMode!==null){const e=[...N.find(this.$refs.currentNode.parentElement,".p-treenode")];l.currentTarget.tabIndex=t===!1?-1:0,e.every(i=>i.tabIndex===-1)&&(e[0].tabIndex=0)}},focusRowChange(l,t,e){l.tabIndex="-1",t.tabIndex="0",this.focusNode(e||t)},findBeforeClickableNode(l){const t=l.closest("ul").closest("li");if(t){const e=N.findSingle(t,"button");return e&&e.style.visibility!=="hidden"?t:this.findBeforeClickableNode(l.previousElementSibling)}return null},toggleCheckbox(){let l=this.selectionKeys?{...this.selectionKeys}:{};const t=!this.checked;this.propagateDown(this.node,t,l),this.$emit("checkbox-change",{node:this.node,check:t,selectionKeys:l})},propagateDown(l,t,e){if(t?e[l.key]={checked:!0,partialChecked:!1}:delete e[l.key],l.children&&l.children.length)for(let i of l.children)this.propagateDown(i,t,e)},propagateUp(l){let t=l.check,e={...l.selectionKeys},i=0,s=!1;for(let n of this.node.children)e[n.key]&&e[n.key].checked?i++:e[n.key]&&e[n.key].partialChecked&&(s=!0);t&&i===this.node.children.length?e[this.node.key]={checked:!0,partialChecked:!1}:(t||delete e[this.node.key],s||i>0&&i!==this.node.children.length?e[this.node.key]={checked:!1,partialChecked:!0}:delete e[this.node.key]),this.$emit("checkbox-change",{node:l.node,check:l.check,selectionKeys:e})},onChildCheckboxChange(l){this.$emit("checkbox-change",l)},findNextSiblingOfAncestor(l){let t=this.getParentNodeElement(l);return t?t.nextElementSibling?t.nextElementSibling:this.findNextSiblingOfAncestor(t):null},findLastVisibleDescendant(l){const t=l.children[1];if(t){const e=t.children[t.children.length-1];return this.findLastVisibleDescendant(e)}else return l},getParentNodeElement(l){const t=l.parentElement.parentElement;return N.hasClass(t,"p-treenode")?t:null},focusNode(l){l.focus()},isCheckboxSelectionMode(){return this.selectionMode==="checkbox"},isSameNode(l){return l.currentTarget&&(l.currentTarget.isSameNode(l.target)||l.currentTarget.isSameNode(l.target.closest(".p-treenode")))}},computed:{hasChildren(){return this.node.children&&this.node.children.length>0},expanded(){return this.expandedKeys&&this.expandedKeys[this.node.key]===!0},leaf(){return this.node.leaf===!1?!1:!(this.node.children&&this.node.children.length)},selectable(){return this.node.selectable===!1?!1:this.selectionMode!=null},selected(){return this.selectionMode&&this.selectionKeys?this.selectionKeys[this.node.key]===!0:!1},containerClass(){return["p-treenode",{"p-treenode-leaf":this.leaf}]},contentClass(){return["p-treenode-content",this.node.styleClass,{"p-treenode-selectable":this.selectable,"p-highlight":this.checkboxMode?this.checked:this.selected}]},icon(){return["p-treenode-icon",this.node.icon]},toggleIcon(){return["p-tree-toggler-icon pi pi-fw",this.expanded?this.node.expandedIcon||"pi-chevron-down":this.node.collapsedIcon||"pi-chevron-right"]},checkboxClass(){return["p-checkbox-box",{"p-highlight":this.checked,"p-indeterminate":this.partialChecked}]},checkboxIcon(){return["p-checkbox-icon",{"pi pi-check":this.checked,"pi pi-minus":this.partialChecked}]},checkboxMode(){return this.selectionMode==="checkbox"&&this.node.selectable!==!1},checked(){return this.selectionKeys?this.selectionKeys[this.node.key]&&this.selectionKeys[this.node.key].checked:!1},partialChecked(){return this.selectionKeys?this.selectionKeys[this.node.key]&&this.selectionKeys[this.node.key].partialChecked:!1},ariaChecked(){return this.selectionMode==="single"||this.selectionMode==="multiple"?this.selected:void 0},ariaSelected(){return this.checkboxMode?this.checked:void 0}},directives:{ripple:ae}};const ye=["aria-label","aria-selected","aria-expanded","aria-setsize","aria-posinset","aria-level","aria-checked","tabindex"],be={key:0,class:"p-checkbox p-component","aria-hidden":"true"},xe={class:"p-treenode-label"},ke={key:0,class:"p-treenode-children",role:"group"};function ve(l,t,e,i,s,n){const p=W("TreeNode",!0),w=de("ripple");return a(),u("li",{ref:"currentNode",class:T(n.containerClass),role:"treeitem","aria-label":n.label(e.node),"aria-selected":n.ariaSelected,"aria-expanded":n.expanded,"aria-setsize":e.node.children?e.node.children.length:0,"aria-posinset":e.index+1,"aria-level":e.level,"aria-checked":n.ariaChecked,tabindex:e.index===0?0:-1,onKeydown:t[3]||(t[3]=(...g)=>n.onKeyDown&&n.onKeyDown(...g))},[b("div",{class:T(n.contentClass),onClick:t[1]||(t[1]=(...g)=>n.onClick&&n.onClick(...g)),onTouchend:t[2]||(t[2]=(...g)=>n.onTouchEnd&&n.onTouchEnd(...g)),style:Q(e.node.style)},[J((a(),u("button",{type:"button",class:"p-tree-toggler p-link",onClick:t[0]||(t[0]=(...g)=>n.toggle&&n.toggle(...g)),tabindex:"-1","aria-hidden":"true"},[b("span",{class:T(n.toggleIcon)},null,2)])),[[w]]),n.checkboxMode?(a(),u("div",be,[b("div",{class:T(n.checkboxClass),role:"checkbox"},[b("span",{class:T(n.checkboxIcon)},null,2)],2)])):v("",!0),b("span",{class:T(n.icon)},null,2),b("span",xe,[e.templates[e.node.type]||e.templates.default?(a(),k(re(e.templates[e.node.type]||e.templates.default),{key:0,node:e.node},null,8,["node"])):(a(),u(_,{key:1},[V(M(n.label(e.node)),1)],64))])],38),n.hasChildren&&n.expanded?(a(),u("ul",ke,[(a(!0),u(_,null,A(e.node.children,g=>(a(),k(p,{key:g.key,node:g,templates:e.templates,level:e.level+1,expandedKeys:e.expandedKeys,onNodeToggle:n.onChildNodeToggle,onNodeClick:n.onChildNodeClick,selectionMode:e.selectionMode,selectionKeys:e.selectionKeys,onCheckboxChange:n.propagateUp},null,8,["node","templates","level","expandedKeys","onNodeToggle","onNodeClick","selectionMode","selectionKeys","onCheckboxChange"]))),128))])):v("",!0)],42,ye)}ne.render=ve;var se={name:"Tree",emits:["node-expand","node-collapse","update:expandedKeys","update:selectionKeys","node-select","node-unselect"],props:{value:{type:null,default:null},expandedKeys:{type:null,default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},metaKeySelection:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:"pi pi-spinner"},filter:{type:Boolean,default:!1},filterBy:{type:String,default:"label"},filterMode:{type:String,default:"lenient"},filterPlaceholder:{type:String,default:null},filterLocale:{type:String,default:void 0},scrollHeight:{type:String,default:null},level:{type:Number,default:0},"aria-labelledby":{type:String,default:null},"aria-label":{type:String,default:null}},data(){return{d_expandedKeys:this.expandedKeys||{},filterValue:null}},watch:{expandedKeys(l){this.d_expandedKeys=l}},methods:{onNodeToggle(l){const t=l.key;this.d_expandedKeys[t]?(delete this.d_expandedKeys[t],this.$emit("node-collapse",l)):(this.d_expandedKeys[t]=!0,this.$emit("node-expand",l)),this.d_expandedKeys={...this.d_expandedKeys},this.$emit("update:expandedKeys",this.d_expandedKeys)},onNodeClick(l){if(this.selectionMode!=null&&l.node.selectable!==!1){const e=(l.nodeTouched?!1:this.metaKeySelection)?this.handleSelectionWithMetaKey(l):this.handleSelectionWithoutMetaKey(l);this.$emit("update:selectionKeys",e)}},onCheckboxChange(l){this.$emit("update:selectionKeys",l.selectionKeys),l.check?this.$emit("node-select",l.node):this.$emit("node-unselect",l.node)},handleSelectionWithMetaKey(l){const t=l.originalEvent,e=l.node,i=t.metaKey||t.ctrlKey,s=this.isNodeSelected(e);let n;return s&&i?(this.isSingleSelectionMode()?n={}:(n={...this.selectionKeys},delete n[e.key]),this.$emit("node-unselect",e)):(this.isSingleSelectionMode()?n={}:this.isMultipleSelectionMode()&&(n=i?this.selectionKeys?{...this.selectionKeys}:{}:{}),n[e.key]=!0,this.$emit("node-select",e)),n},handleSelectionWithoutMetaKey(l){const t=l.node,e=this.isNodeSelected(t);let i;return this.isSingleSelectionMode()?e?(i={},this.$emit("node-unselect",t)):(i={},i[t.key]=!0,this.$emit("node-select",t)):e?(i={...this.selectionKeys},delete i[t.key],this.$emit("node-unselect",t)):(i=this.selectionKeys?{...this.selectionKeys}:{},i[t.key]=!0,this.$emit("node-select",t)),i},isSingleSelectionMode(){return this.selectionMode==="single"},isMultipleSelectionMode(){return this.selectionMode==="multiple"},isNodeSelected(l){return this.selectionMode&&this.selectionKeys?this.selectionKeys[l.key]===!0:!1},isChecked(l){return this.selectionKeys?this.selectionKeys[l.key]&&this.selectionKeys[l.key].checked:!1},isNodeLeaf(l){return l.leaf===!1?!1:!(l.children&&l.children.length)},onFilterKeydown(l){l.which===13&&l.preventDefault()},findFilteredNodes(l,t){if(l){let e=!1;if(l.children){let i=[...l.children];l.children=[];for(let s of i){let n={...s};this.isFilterMatched(n,t)&&(e=!0,l.children.push(n))}}if(e)return!0}},isFilterMatched(l,{searchFields:t,filterText:e,strict:i}){let s=!1;for(let n of t)String(ce.resolveFieldData(l,n)).toLocaleLowerCase(this.filterLocale).indexOf(e)>-1&&(s=!0);return(!s||i&&!this.isNodeLeaf(l))&&(s=this.findFilteredNodes(l,{searchFields:t,filterText:e,strict:i})||s),s}},computed:{containerClass(){return["p-tree p-component",{"p-tree-selectable":this.selectionMode!=null,"p-tree-loading":this.loading,"p-tree-flex-scrollable":this.scrollHeight==="flex"}]},loadingIconClass(){return["p-tree-loading-icon pi-spin",this.loadingIcon]},filteredValue(){let l=[];const t=this.filterBy.split(","),e=this.filterValue.trim().toLocaleLowerCase(this.filterLocale),i=this.filterMode==="strict";for(let s of this.value){let n={...s},p={searchFields:t,filterText:e,strict:i};(i&&(this.findFilteredNodes(n,p)||this.isFilterMatched(n,p))||!i&&(this.isFilterMatched(n,p)||this.findFilteredNodes(n,p)))&&l.push(n)}return l},valueToRender(){return this.filterValue&&this.filterValue.trim().length>0?this.filteredValue:this.value}},components:{TreeNode:ne}};const Ce={key:0,class:"p-tree-loading-overlay p-component-overlay"},we={key:1,class:"p-tree-filter-container"},Ke=["placeholder"],Se=b("span",{class:"p-tree-filter-icon pi pi-search"},null,-1),Ve=["aria-labelledby","aria-label"];function Te(l,t,e,i,s,n){const p=W("TreeNode");return a(),u("div",{class:T(n.containerClass)},[e.loading?(a(),u("div",Ce,[b("i",{class:T(n.loadingIconClass)},null,2)])):v("",!0),e.filter?(a(),u("div",we,[J(b("input",{"onUpdate:modelValue":t[0]||(t[0]=w=>s.filterValue=w),type:"text",autocomplete:"off",class:"p-tree-filter p-inputtext p-component",placeholder:e.filterPlaceholder,onKeydown:t[1]||(t[1]=(...w)=>n.onFilterKeydown&&n.onFilterKeydown(...w))},null,40,Ke),[[ue,s.filterValue]]),Se])):v("",!0),b("div",{class:"p-tree-wrapper",style:Q({maxHeight:e.scrollHeight})},[b("ul",{class:"p-tree-container",role:"tree","aria-labelledby":l.ariaLabelledby,"aria-label":l.ariaLabel},[(a(!0),u(_,null,A(n.valueToRender,(w,g)=>(a(),k(p,{key:w.key,node:w,templates:l.$slots,level:e.level+1,index:g,expandedKeys:s.d_expandedKeys,onNodeToggle:n.onNodeToggle,onNodeClick:n.onNodeClick,selectionMode:e.selectionMode,selectionKeys:e.selectionKeys,onCheckboxChange:n.onCheckboxChange},null,8,["node","templates","level","index","expandedKeys","onNodeToggle","onNodeClick","selectionMode","selectionKeys","onCheckboxChange"]))),128))],8,Ve)],4)],2)}function _e(l,t){t===void 0&&(t={});var e=t.insertAt;if(!(!l||typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",e==="top"&&i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s),s.styleSheet?s.styleSheet.cssText=l:s.appendChild(document.createTextNode(l))}}var Ne=`
.p-tree-container {
    margin: 0;
    padding: 0;
    list-style-type: none;
    overflow: auto;
}
.p-treenode-children {
    margin: 0;
    padding: 0;
    list-style-type: none;
}
.p-tree-wrapper {
    overflow: auto;
}
.p-treenode-selectable {
    cursor: pointer;
    -webkit-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
            user-select: none;
}
.p-tree-toggler {
    cursor: pointer;
    -webkit-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
            user-select: none;
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    overflow: hidden;
    position: relative;
    -ms-flex-negative: 0;
        flex-shrink: 0;
}
.p-treenode-leaf > .p-treenode-content .p-tree-toggler {
    visibility: hidden;
}
.p-treenode-content {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
}
.p-tree-filter {
    width: 100%;
}
.p-tree-filter-container {
    position: relative;
    display: block;
    width: 100%;
}
.p-tree-filter-icon {
    position: absolute;
    top: 50%;
    margin-top: -0.5rem;
}
.p-tree-loading {
    position: relative;
    min-height: 4rem;
}
.p-tree .p-tree-loading-overlay {
    position: absolute;
    z-index: 1;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
}
.p-tree-flex-scrollable {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-flex: 1;
        -ms-flex: 1;
            flex: 1;
    height: 100%;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
}
.p-tree-flex-scrollable .p-tree-wrapper {
    -webkit-box-flex: 1;
        -ms-flex: 1;
            flex: 1;
}
`;_e(Ne);se.render=Te;const Me=b("p",null,"blah",-1),Ee=I({__name:"RuleTree",props:{value:null,moveRule:null},emits:["pickGlobal"],setup(l,{emit:t}){const e=l,i=he();O(),i.globalRules;const s=p=>{console.log("selected node",p),p.key&&t("pickGlobal",p.key)},n=p=>{console.log("onEnd",p),e.moveRule(p.oldIndex,p.newIndex)};return(p,w)=>(a(),u(_,null,[x(c(se),{value:e.value,"selection-mode":"single",onNodeSelect:s},null,8,["value"]),x(c(X),{list:e.value,"item-key":"key",tag:"ul",onEnd:n,class:"p-tree-container"},{item:y(({element:g,index:f})=>[(a(),u("li",{class:"draggable p-tree-node",key:g.key},[x(c(me),{label:g.label,icon:"pi pi-bars"},null,8,["label"])]))]),default:y(()=>[Me]),_:1},8,["list"])],64))}});var H={name:"Toolbar",props:{"aria-labelledby":{type:String,default:null}}};const Re=["aria-labelledby"],$e={class:"p-toolbar-group-start p-toolbar-group-left"},Ae={class:"p-toolbar-group-center"},Ie={class:"p-toolbar-group-end p-toolbar-group-right"};function Ue(l,t,e,i,s,n){return a(),u("div",{class:"p-toolbar p-component",role:"toolbar","aria-labelledby":l.ariaLabelledby},[b("div",$e,[B(l.$slots,"start")]),b("div",Ae,[B(l.$slots,"center")]),b("div",Ie,[B(l.$slots,"end")])],8,Re)}function Pe(l,t){t===void 0&&(t={});var e=t.insertAt;if(!(!l||typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",e==="top"&&i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s),s.styleSheet?s.styleSheet.cssText=l:s.appendChild(document.createTextNode(l))}}var De=`
.p-toolbar {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: justify;
        -ms-flex-pack: justify;
            justify-content: space-between;
    -ms-flex-wrap: wrap;
        flex-wrap: wrap;
}
.p-toolbar-group-start,
.p-toolbar-group-center,
.p-toolbar-group-end {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
}
.p-toolbar-group-left,
.p-toolbar-group-right {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
}
`;Pe(De);H.render=Ue;const Le={class:"grid"},Be={class:"col-2"},Fe={class:"col"},Ge={key:1,class:"grid"},je={class:"col-12"},ie=I({__name:"RuleMatch",props:{modelValue:null},emits:["update:modelValue"],setup(l,{emit:t}){const e=l,i=P(!1),s=z(()=>i?"Match":"Match.. "+Object.keys(e.modelValue).join(",")),n=(f,m)=>{console.log(`updating old key: ${f} to ${m}`);let h=e.modelValue;h[m]=h[f],delete h[f]},p=(f,m,h)=>{console.log("Updating KV",f,m,h);const C=e.modelValue[f];U(C)?C.splice(m,1,h):F(C)&&(e.modelValue[f]=h)},w=(f,m)=>{console.log("Removing KI",f,m);const h=e.modelValue[f];U(h)&&h.splice(m,1)},g=f=>{if(U(e.modelValue[f])){console.log("adding row to array for key ",f);const m=e.modelValue[f];let h=U(m)?m:[m];h.push("");let C=e.modelValue;C[f]=h,t("update:modelValue",C)}else{let m=e.modelValue[f];if(console.log("dict key = ",f),console.log("dict value = ",m),F(m)){let h=[m];h.push(""),e.modelValue,e.modelValue[f]=h}}};return(f,m)=>(a(),k(c(Y),{header:c(s),toggleable:!0,collapsed:i.value,"onUpdate:collapsed":m[0]||(m[0]=h=>i.value=h)},{default:y(()=>[(a(!0),u(_,null,A(e.modelValue,(h,C,D)=>(a(),u("div",Le,[b("div",Be,[x(c($),{value:C,type:"text","onUpdate:modelValue":S=>n(C,S)},null,8,["value","onUpdate:modelValue"])]),b("div",Fe,[c(F)(h)?(a(),k(c($),{key:0,value:h,"onUpdate:modelValue":S=>p(C,-1,S),type:"text"},null,8,["value","onUpdate:modelValue"])):c(U)(h)?(a(),u("div",Ge,[(a(!0),u(_,null,A(h,(S,E)=>(a(),u("div",je,[x(c($),{placeholder:"String",value:S,type:"text","onUpdate:modelValue":R=>p(C,E,R)},null,8,["value","onUpdate:modelValue"]),x(c(G),{icon:"pi pi-times",class:"p-button-rounded p-button-danger p-button-text",onClick:R=>w(C,E)},null,8,["onClick"])]))),256))])):v("",!0),x(c(G),{label:"Add",icon:"pi pi-plus",onClick:S=>g(C)},null,8,["onClick"])])]))),256))]),_:1},8,["header","collapsed"]))}}),Oe={key:0,style:{"list-style":"none"}},ze={style:{margin:"5px"}},oe=I({__name:"Rule",props:{rule:null},emits:["save"],setup(l,{emit:t}){const e=l,i=P([{label:"off",value:!1},{label:"on",value:!0}]),s=q({editTitle:!1,showPencil:!1}),n=P([{label:"Match",icon:"pi pi-plus",command:o=>{console.log("X",o),e.rule.match===void 0?e.rule.match={"":""}:e.rule.match[""]=[]}},{label:"Equals",icon:"pi pi-plus"},{label:"Exists",icon:"pi pi-plus",command:()=>{if(e.rule.exists===void 0)e.rule.exists=["changeme"],t("save",e.rule);else if(p(e.rule.exists)){console.log("exists already existed");let o=e.rule.exists;e.rule.exists=[o,"changeme"]}else w(e.rule.exists)&&e.rule.exists.push("changeme")}},{label:"Missing",icon:"pi pi-plus",command:()=>{if(e.rule.missing===void 0)e.rule.missing=["changeme"];else if(p(e.rule.missing)){let o=e.rule.missing;e.rule.missing=[o,"changeme"]}else w(e.rule.missing)&&e.rule.missing.push("changeme")}}]),p=o=>typeof o=="string",w=o=>Array.isArray(o),g=z(()=>{let o=[];return e.rule.all!==void 0&&o.push({all:e.rule.all}),e.rule.equals!==void 0&&o.push({equals:e.rule.equals}),e.rule.missing!==void 0&&o.push({missing:e.rule.missing}),e.rule.exists!==void 0&&o.push({exists:e.rule.exists}),e.rule.match!==void 0&&o.push({match:e.rule.match}),o}),f=o=>{let d={...e.rule,missing:o};console.log("Saving",d),t("save",d)},m=o=>{let d={...e.rule,exists:o};console.log("Saving",d),t("save",d)},h=o=>{let d={...e.rule,match:o};console.log("Saving match",d),t("save",d)},C=()=>{let o={...e.rule};delete o.exists,t("save",o)},D=()=>{let o={...e.rule};delete o.missing,t("save",o)},S=o=>{e.rule.name=o},E=()=>{s.editTitle=s.editTitle===!1},R=o=>{console.log("LOG",o)};return(o,d)=>e.rule?(a(),k(c(j),{key:0},{title:y(()=>[s.editTitle?(a(),k(c($),{key:1,value:e.rule.name,type:"text","onUpdate:modelValue":S,onFocusout:d[3]||(d[3]=r=>s.editTitle=!1)},null,8,["value"])):(a(),u("div",{key:0,onDblclick:d[0]||(d[0]=r=>s.editTitle=!0),onPointerover:d[1]||(d[1]=r=>s.showPencil=!0),onPointerleave:d[2]||(d[2]=r=>s.showPencil=!1)},[V(" Rule: "+M(e.rule.name)+" ",1),s.showPencil?(a(),u("i",{key:0,class:"pi pi-pencil",onClick:E})):v("",!0)],32))]),subtitle:y(()=>[V(M(e.rule.uuid),1)]),content:y(()=>[c(g).length>0?(a(),u("ul",Oe,[(a(!0),u(_,null,A(c(g),r=>(a(),u("li",ze,[r.all!==void 0?(a(),k(c(Z),{key:0,"onUpdate:modelValue":[R,K=>r.all=K],modelValue:r.all,options:i.value,"option-label":"label","option-value":"value"},null,8,["modelValue","onUpdate:modelValue","options"])):v("",!0),r.missing!==void 0?(a(),k(ee,{key:1,modelValue:r.missing,"onUpdate:modelValue":[K=>r.missing=K,f],"onRemove:modelValue":D},null,8,["modelValue","onUpdate:modelValue"])):v("",!0),r.exists!==void 0?(a(),k(le,{key:2,modelValue:r.exists,"onUpdate:modelValue":[K=>r.exists=K,m],"onRemove:modelValue":C},null,8,["modelValue","onUpdate:modelValue"])):v("",!0),r.match!==void 0?(a(),k(ie,{key:3,modelValue:r.match,"onUpdate:modelValue":[K=>r.match=K,h]},null,8,["modelValue","onUpdate:modelValue"])):v("",!0)]))),256))])):(a(),k(c(j),{key:1},{title:y(()=>[V(" Add rules")]),content:y(()=>[V(" This rule is missing some selectors ")]),_:1}))]),footer:y(()=>[x(c(H),null,{start:y(()=>[x(c(te),{label:"add",icon:"pi pi-plus",model:n.value},null,8,["model"])]),_:1})]),_:1})):v("",!0)}}),qe=I({__name:"RulePanel",props:{rule:null},setup(l){const t=l,e=q({editTitle:!1,showPencil:!1});return(i,s)=>(a(),k(c(Y),{collapsed:!0,toggleable:!0},pe({default:y(()=>[x(oe,{rule:t.rule},null,8,["rule"])]),_:2},[e.editTitle?{name:"header",fn:y(()=>[x(c($),{value:t.rule.name,type:"text","onUpdate:modelValue":s[4]||(s[4]=n=>t.rule.name=n),onFocusout:s[5]||(s[5]=n=>e.editTitle=!1)},null,8,["value"])]),key:"1"}:{name:"header",fn:y(()=>[b("div",{onDblclick:s[1]||(s[1]=n=>e.editTitle=!0),onMouseover:s[2]||(s[2]=n=>e.showPencil=!0),onMouseleave:s[3]||(s[3]=n=>e.showPencil=!1)},[V(M(t.rule.name)+" ",1),e.showPencil?(a(),u("i",{key:0,class:"pi pi-pencil",onClick:s[0]||(s[0]=n=>e.editTitle=!e.editTitle)})):v("",!0)],32)]),key:"0"}]),1024))}}),He=I({__name:"GroupRule",props:{rule:null},emits:["save"],setup(l,{emit:t}){const e=l,i=O(),s=P([{label:"off",value:!1},{label:"on",value:!0}]),n=q({editTitle:!1,showPencil:!1}),p=P([{label:"Add Rule",icon:"pi pi-plus",command:o=>{i.addRuleToGroup(e.rule.uuid)}}]),w=z(()=>{let o=[];return e.rule.all!==void 0&&o.push({all:e.rule.all}),e.rule.equals!==void 0&&o.push({equals:e.rule.equals}),e.rule.missing!==void 0&&o.push({missing:e.rule.missing}),e.rule.exists!==void 0&&o.push({exists:e.rule.exists}),e.rule.match!==void 0&&o.push({match:e.rule.match}),o}),g=(o,d)=>{i.moveRuleInGroup(o,d.oldIndex,d.newIndex)},f=o=>{let d={...e.rule,missing:o};console.log("Saving",d),t("save",d)},m=o=>{let d={...e.rule,exists:o};console.log("Saving",d),t("save",d)},h=o=>{let d={...e.rule,match:o};console.log("Saving match",d),t("save",d)},C=()=>{let o={...e.rule};delete o.exists,t("save",o)},D=()=>{let o={...e.rule};delete o.missing,t("save",o)},S=o=>{e.rule.name=o},E=()=>{n.editTitle=n.editTitle===!1},R=o=>{console.log("LOG",o)};return(o,d)=>e.rule?(a(),k(c(j),{key:0},{title:y(()=>[n.editTitle?(a(),k(c($),{key:1,value:e.rule.name,type:"text","onUpdate:modelValue":S,onFocusout:d[3]||(d[3]=r=>n.editTitle=!1)},null,8,["value"])):(a(),u("div",{key:0,onDblclick:d[0]||(d[0]=r=>n.editTitle=!0),onPointerover:d[1]||(d[1]=r=>n.showPencil=!0),onPointerleave:d[2]||(d[2]=r=>n.showPencil=!1)},[V(" Group Rule: "+M(e.rule.name)+" ",1),n.showPencil?(a(),u("i",{key:0,class:"pi pi-pencil",onClick:E})):v("",!0)],32))]),subtitle:y(()=>[V(M(e.rule.uuid),1)]),content:y(()=>[b("ul",null,[(a(!0),u(_,null,A(c(w),r=>(a(),u("li",null,[r.all!==void 0?(a(),k(c(Z),{key:0,"onUpdate:modelValue":[R,K=>r.all=K],modelValue:r.all,options:s.value,"option-label":"label","option-value":"value"},null,8,["modelValue","onUpdate:modelValue","options"])):v("",!0),r.missing!==void 0?(a(),k(ee,{key:1,modelValue:r.missing,"onUpdate:modelValue":[K=>r.missing=K,f],"onRemove:modelValue":D},null,8,["modelValue","onUpdate:modelValue"])):v("",!0),r.exists!==void 0?(a(),k(le,{key:2,modelValue:r.exists,"onUpdate:modelValue":[K=>r.exists=K,m],"onRemove:modelValue":C},null,8,["modelValue","onUpdate:modelValue"])):v("",!0),r.match!==void 0?(a(),k(ie,{key:3,modelValue:r.match,"onUpdate:modelValue":[K=>r.match=K,h]},null,8,["modelValue","onUpdate:modelValue"])):v("",!0)]))),256))]),x(c(X),{class:"",style:{"list-style":"none"},list:e.rule.rules,"item-key":"uuid",tag:"ul",onEnd:d[4]||(d[4]=r=>g(e.rule.uuid,r))},{header:y(()=>[V(" rule count: "+M(e.rule.rules.length),1)]),item:y(({element:r,index:K})=>[(a(),u("li",{class:"draggable",style:{margin:"5px"},key:r.uuid},[x(qe,{rule:r},null,8,["rule"])]))]),_:1},8,["list"])]),footer:y(()=>[x(c(H),null,{start:y(()=>[x(c(te),{label:"add",icon:"pi pi-plus",model:p.value},null,8,["model"])]),_:1})]),_:1})):v("",!0)}}),We={class:"grid"},Je={class:"col-2"},Qe={key:0,class:"col"},Xe={key:1,class:"col"},tl=I({__name:"GroupRulesView",setup(l){const t=O();fe(()=>{t.load([{uuid:L(),name:"1st group",rules:[{uuid:L(),name:"1st rule"}]},{uuid:L(),name:"2nd group",rules:[]},{uuid:L(),name:"3rd group",rules:[]}])});const e=s=>{console.log("global clicked",s),t.setRuleSelected(s,void 0)},i=()=>{t.addGroup()};return(s,n)=>(a(),u("div",We,[b("div",Je,[x(Ee,{value:c(t).rules,"move-rule":c(t).moveRule,onPickGlobal:e},null,8,["value","move-rule"]),x(c(ge)),x(c(G),{onClick:i},{default:y(()=>[V("Add Rule")]),_:1})]),c(t).selectedGroupRule?(a(),u("div",Qe,[x(He,{rule:c(t).selectedGroupRule},null,8,["rule"])])):c(t).selectedRule?(a(),u("div",Xe,[x(oe,{rule:c(t).selectedRule},null,8,["rule"])])):v("",!0)]))}});export{tl as default};
