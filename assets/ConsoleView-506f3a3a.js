import{d as C,u as B,r as o,F as f,a as _,i as U,o as A,c as T,b as a,w as r,e as c,f as l,s as j,t as b,g as w,h as z,j as h,k as n,l as J,m as H,n as q,p as G,q as K,v as L,_ as Q,x as W}from"./index-51300225.js";import"./splitbutton.esm-10822ac8.js";const E=u=>(K("data-v-c6d1c8d1"),u=u(),L(),u),P={class:"flex justify-content-between"},X={class:"flex flex-row"},Y=E(()=>c("b",null,"Filter: ",-1)),Z={class:"p-input-icon-left"},ee=E(()=>c("i",{class:"pi pi-search"},null,-1)),te=C({__name:"EventConsole",setup(u){const p=B(),g=o(),x=o(),m=o([]);o();const V=o([]),v=o(),I=o([{label:"Severity 1"}]),y=o({global:{value:null,matchMode:f.CONTAINS},summary:{operator:_.AND,constraints:[{value:null,matchMode:f.CONTAINS}]},severity:{operator:_.OR,constraints:[{value:null,matchMode:f.EQUALS}]},group:{operator:_.AND,constraints:[{value:null,matchMode:f.ENDS_WITH}]}}),S=o("sev1"),F=o([{name:"severity 1",code:"sev1"},{name:"severity 2",code:"sev2"},{name:"severity 3",code:"sev3"}]);o([{label:"Filter",icon:"pi pi-file",items:I}]),o([{label:"File",icon:"pi pi-fw pi-file",items:[{label:"New",icon:"pi pi-fw pi-plus",items:[{label:"Bookmark",icon:"pi pi-fw pi-bookmark"},{label:"Video",icon:"pi pi-fw pi-video"}]}]},{label:"Filter",icon:"pi pi-fw pi-file",items:[]}]);const N=o([{label:"View",icon:"pi pi-fw pi-search",command:()=>{}},{label:"Delete",icon:"pi pi-fw pi-times",command:()=>{}},{label:"Acknowledge",command:()=>{k(!0)}},{label:"Unacknowledge",command:()=>{k(!1)}},{label:"Severity",items:[{label:"Critical",command:()=>{d(5)},class:"ev-severity-5"},{label:"Major",command:()=>{d(4)},class:"ev-severity-4"},{label:"Minor",command:()=>{d(3)},class:"ev-severity-3"},{label:"Intermediate",command:()=>{d(2)},class:"ev-severity-2"},{label:"Info",command:()=>{d(1)},class:"ev-severity-1"},{label:"Clear",command:()=>{d(0)},class:"ev-severity-0"}]}]),d=s=>{const t=new Set([...m.value.map(i=>i.uuid)]);let e=v.value;U(e)&&t.add(e.uuid),p.setSeverity(Array.from(t),s)},k=s=>{const t=[];let e=v.value;U(e)&&t.push(e.uuid),t.push(...m.value.map(i=>i.uuid)),p.setAcknowledement(t,s)},M=o({labels:["January","February","March","April","May","June","July"],datasets:[{label:"Occurrences",backgroundColor:"#42A5F5",data:[65,59,80,81,56,55,40],fill:!0,tension:.4,borderColor:"#42A5F5"}]}),D=o({plugins:{legend:{labels:{color:"#495057"}}},scales:{x:{ticks:{color:"#495057"},grid:{color:"#ebedef"}},y:{ticks:{color:"#495057"},grid:{color:"#ebedef"}}}}),O=s=>{const t="ev-severity-"+s.severity,e=s.acknowledged===!0?" ev-acknowledged":"";return t+e},$=s=>{console.log("expanded row",s)},R=s=>{x.value.show(s.originalEvent)};return(s,t)=>(A(),T(G,null,[a(l(H),{ref_key:"ec",ref:g,class:"p-datatable-sm",value:l(p).events,selection:m.value,"onUpdate:selection":t[2]||(t[2]=e=>m.value=e),"expanded-rows":V.value,"onUpdate:expanded-rows":t[3]||(t[3]=e=>V.value=e),"context-menu-selection":v.value,"onUpdate:context-menu-selection":t[4]||(t[4]=e=>v.value=e),filters:y.value,"onUpdate:filters":t[5]||(t[5]=e=>y.value=e),"global-filter-fields":["summary","group"],"filter-display":"menu","data-key":"uuid",scrollable:"","scroll-height":"700px","row-class":O,"resizable-columns":!0,contextmenu:"",onRowContextmenu:R,onRowExpand:$,"selection-mode":"multiple","column-resize-mode":"fit","reorderable-columns":!0,"sort-mode":"multiple","virtual-scroller-options":{itemSize:39,numToleratedItems:200}},{header:r(()=>[c("div",P,[c("div",X,[Y,a(l(j),{class:"light-drop-down",modelValue:S.value,"onUpdate:modelValue":t[0]||(t[0]=e=>S.value=e),options:F.value,"option-value":"code","option-label":"name"},null,8,["modelValue","options"]),c("b",null," selected: "+b(m.value.length),1)]),c("span",Z,[ee,a(l(w),{modelValue:y.value.global.value,"onUpdate:modelValue":t[1]||(t[1]=e=>y.value.global.value=e),placeholder:"Keyword Search"},null,8,["modelValue"])])])]),expansion:r(e=>[a(l(z),{type:"line",width:600,data:M.value,options:D.value},null,8,["data","options"]),h(" UUID: "+b(e.data.uuid),1)]),default:r(()=>[a(l(n),{expander:!0,style:{width:"2rem"},"header-style":"width: 1rem;","body-style":"text-align: center; overflow: visible"},{header:r(()=>[]),_:1}),a(l(n),{field:"uuid",header:"UUID",hidden:!0,style:{"min-width":"5rem"}}),a(l(n),{field:"acknowledged",header:"Ack",hidden:!0,style:{"min-width":"5rem"}}),a(l(n),{field:"node",header:"Hostname","data-type":"string",sortable:!0}),a(l(n),{field:"agent",header:"Agent","data-type":"string",sortable:!0}),a(l(n),{field:"group",header:"Group",sortable:!0,style:{"min-width":"15rem"}},{filter:r(({filterModel:e})=>[a(l(w),{modelValue:e.value,"onUpdate:modelValue":i=>e.value=i},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(l(n),{field:"severity",header:"Severity","data-type":"numeric",sortable:!0,style:{"min-width":"8rem"}},{filter:r(({filterModel:e})=>[a(l(J),{modelValue:e.value,"onUpdate:modelValue":i=>e.value=i,mode:"decimal"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(l(n),{field:"tally",header:"Count","data-type":"numeric",sortable:!0,style:{"min-width":"8rem"}}),a(l(n),{field:"created_at",header:"First Occurrence","data-type":"date",sortable:!0},{body:r(e=>[h(b(new Date(e.data.created_at).toISOString()),1)]),_:1}),a(l(n),{field:"summary",header:"Summary",sortable:!0,style:{"min-width":"15rem"},"filter-match-mode":"contains"},{body:r(e=>[h(b(e.data.summary),1)]),filter:r(({filterModel:e})=>[a(l(w),{type:"text",modelValue:e.value,"onUpdate:modelValue":i=>e.value=i,class:"p-column-filter",placeholder:"Search by name"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["value","selection","expanded-rows","context-menu-selection","filters"]),a(l(q),{model:N.value,ref_key:"cm",ref:x},null,8,["model"])],64))}});const le=Q(te,[["__scopeId","data-v-c6d1c8d1"]]),se=C({__name:"ConsoleView",setup(u){return(p,g)=>(A(),W(le))}});export{se as default};
