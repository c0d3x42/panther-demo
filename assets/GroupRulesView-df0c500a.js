import{D as w,R as oe,r as H,a as ae,o as a,b as c,f as C,e as z,n as N,h as b,c as x,u as de,q as _,j as T,t as M,a2 as W,l as I,a1 as re,ak as ue,x as U,af as ce,al as O,d as k,H as u,w as y,C as P,i as j,Q as A,ad as F,ac as D,J as G,aj as q,I as B,p as he,G as pe,am as L}from"./index-6222cee5.js";import{b as me,d as J,c as Q,s as X,a as Y,_ as Z}from"./panel.esm-83e15c3a.js";import{s as ee}from"./splitbutton.esm-a87bc406.js";import{s as le}from"./toolbar.esm-4d0b98ec.js";import{s as fe}from"./divider.esm-0572037e.js";var te={name:"TreeNode",emits:["node-toggle","node-click","checkbox-change"],props:{node:{type:null,default:null},expandedKeys:{type:null,default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},templates:{type:null,default:null},level:{type:Number,default:null},index:{type:Number,default:null}},nodeTouched:!1,mounted(){this.$refs.currentNode.closest(".p-treeselect-items-wrapper")&&this.setAllNodesTabIndexes()},methods:{toggle(){this.$emit("node-toggle",this.node)},label(l){return typeof l.label=="function"?l.label():l.label},onChildNodeToggle(l){this.$emit("node-toggle",l)},onClick(l){w.hasClass(l.target,"p-tree-toggler")||w.hasClass(l.target.parentElement,"p-tree-toggler")||(this.isCheckboxSelectionMode()?this.toggleCheckbox():this.$emit("node-click",{originalEvent:l,nodeTouched:this.nodeTouched,node:this.node}),this.nodeTouched=!1)},onChildNodeClick(l){this.$emit("node-click",l)},onTouchEnd(){this.nodeTouched=!0},onKeyDown(l){if(this.isSameNode(l))switch(l.code){case"Tab":this.onTabKey(l);break;case"ArrowDown":this.onArrowDown(l);break;case"ArrowUp":this.onArrowUp(l);break;case"ArrowRight":this.onArrowRight(l);break;case"ArrowLeft":this.onArrowLeft(l);break;case"Enter":case"Space":this.onEnterKey(l);break}},onArrowDown(l){const t=l.target,e=t.children[1];if(e)this.focusRowChange(t,e.children[0]);else if(t.nextElementSibling)this.focusRowChange(t,t.nextElementSibling);else{let o=this.findNextSiblingOfAncestor(t);o&&this.focusRowChange(t,o)}l.preventDefault()},onArrowUp(l){const t=l.target;if(t.previousElementSibling)this.focusRowChange(t,t.previousElementSibling,this.findLastVisibleDescendant(t.previousElementSibling));else{let e=this.getParentNodeElement(t);e&&this.focusRowChange(t,e)}l.preventDefault()},onArrowRight(l){this.leaf||this.expanded||(l.currentTarget.tabIndex=-1,this.$emit("node-toggle",this.node),this.$nextTick(()=>{this.onArrowDown(l)}))},onArrowLeft(l){const t=w.findSingle(l.currentTarget,".p-tree-toggler");if(this.level===0&&!this.expanded)return!1;if(this.expanded&&!this.leaf)return t.click(),!1;const e=this.findBeforeClickableNode(l.currentTarget);e&&this.focusRowChange(l.currentTarget,e)},onEnterKey(l){this.setTabIndexForSelectionMode(l,this.nodeTouched),this.onClick(l),l.preventDefault()},onTabKey(){this.setAllNodesTabIndexes()},setAllNodesTabIndexes(){const l=w.find(this.$refs.currentNode.closest(".p-tree-container"),".p-treenode"),t=[...l].some(e=>e.getAttribute("aria-selected")==="true"||e.getAttribute("aria-checked")==="true");if([...l].forEach(e=>{e.tabIndex=-1}),t){const e=[...l].filter(o=>o.getAttribute("aria-selected")==="true"||o.getAttribute("aria-checked")==="true");e[0].tabIndex=0;return}[...l][0].tabIndex=0},setTabIndexForSelectionMode(l,t){if(this.selectionMode!==null){const e=[...w.find(this.$refs.currentNode.parentElement,".p-treenode")];l.currentTarget.tabIndex=t===!1?-1:0,e.every(o=>o.tabIndex===-1)&&(e[0].tabIndex=0)}},focusRowChange(l,t,e){l.tabIndex="-1",t.tabIndex="0",this.focusNode(e||t)},findBeforeClickableNode(l){const t=l.closest("ul").closest("li");if(t){const e=w.findSingle(t,"button");return e&&e.style.visibility!=="hidden"?t:this.findBeforeClickableNode(l.previousElementSibling)}return null},toggleCheckbox(){let l=this.selectionKeys?{...this.selectionKeys}:{};const t=!this.checked;this.propagateDown(this.node,t,l),this.$emit("checkbox-change",{node:this.node,check:t,selectionKeys:l})},propagateDown(l,t,e){if(t?e[l.key]={checked:!0,partialChecked:!1}:delete e[l.key],l.children&&l.children.length)for(let o of l.children)this.propagateDown(o,t,e)},propagateUp(l){let t=l.check,e={...l.selectionKeys},o=0,i=!1;for(let n of this.node.children)e[n.key]&&e[n.key].checked?o++:e[n.key]&&e[n.key].partialChecked&&(i=!0);t&&o===this.node.children.length?e[this.node.key]={checked:!0,partialChecked:!1}:(t||delete e[this.node.key],i||o>0&&o!==this.node.children.length?e[this.node.key]={checked:!1,partialChecked:!0}:delete e[this.node.key]),this.$emit("checkbox-change",{node:l.node,check:l.check,selectionKeys:e})},onChildCheckboxChange(l){this.$emit("checkbox-change",l)},findNextSiblingOfAncestor(l){let t=this.getParentNodeElement(l);return t?t.nextElementSibling?t.nextElementSibling:this.findNextSiblingOfAncestor(t):null},findLastVisibleDescendant(l){const t=l.children[1];if(t){const e=t.children[t.children.length-1];return this.findLastVisibleDescendant(e)}else return l},getParentNodeElement(l){const t=l.parentElement.parentElement;return w.hasClass(t,"p-treenode")?t:null},focusNode(l){l.focus()},isCheckboxSelectionMode(){return this.selectionMode==="checkbox"},isSameNode(l){return l.currentTarget&&(l.currentTarget.isSameNode(l.target)||l.currentTarget.isSameNode(l.target.closest(".p-treenode")))}},computed:{hasChildren(){return this.node.children&&this.node.children.length>0},expanded(){return this.expandedKeys&&this.expandedKeys[this.node.key]===!0},leaf(){return this.node.leaf===!1?!1:!(this.node.children&&this.node.children.length)},selectable(){return this.node.selectable===!1?!1:this.selectionMode!=null},selected(){return this.selectionMode&&this.selectionKeys?this.selectionKeys[this.node.key]===!0:!1},containerClass(){return["p-treenode",{"p-treenode-leaf":this.leaf}]},contentClass(){return["p-treenode-content",this.node.styleClass,{"p-treenode-selectable":this.selectable,"p-highlight":this.checkboxMode?this.checked:this.selected}]},icon(){return["p-treenode-icon",this.node.icon]},toggleIcon(){return["p-tree-toggler-icon pi pi-fw",this.expanded?this.node.expandedIcon||"pi-chevron-down":this.node.collapsedIcon||"pi-chevron-right"]},checkboxClass(){return["p-checkbox-box",{"p-highlight":this.checked,"p-indeterminate":this.partialChecked}]},checkboxIcon(){return["p-checkbox-icon",{"pi pi-check":this.checked,"pi pi-minus":this.partialChecked}]},checkboxMode(){return this.selectionMode==="checkbox"&&this.node.selectable!==!1},checked(){return this.selectionKeys?this.selectionKeys[this.node.key]&&this.selectionKeys[this.node.key].checked:!1},partialChecked(){return this.selectionKeys?this.selectionKeys[this.node.key]&&this.selectionKeys[this.node.key].partialChecked:!1},ariaChecked(){return this.selectionMode==="single"||this.selectionMode==="multiple"?this.selected:void 0},ariaSelected(){return this.checkboxMode?this.checked:void 0}},directives:{ripple:oe}};const ge=["aria-label","aria-selected","aria-expanded","aria-setsize","aria-posinset","aria-level","aria-checked","tabindex"],ye={key:0,class:"p-checkbox p-component","aria-hidden":"true"},ke={class:"p-treenode-label"},xe={key:0,class:"p-treenode-children",role:"group"};function be(l,t,e,o,i,n){const p=H("TreeNode",!0),K=ae("ripple");return a(),c("li",{ref:"currentNode",class:N(n.containerClass),role:"treeitem","aria-label":n.label(e.node),"aria-selected":n.ariaSelected,"aria-expanded":n.expanded,"aria-setsize":e.node.children?e.node.children.length:0,"aria-posinset":e.index+1,"aria-level":e.level,"aria-checked":n.ariaChecked,tabindex:e.index===0?0:-1,onKeydown:t[3]||(t[3]=(...g)=>n.onKeyDown&&n.onKeyDown(...g))},[C("div",{class:N(n.contentClass),onClick:t[1]||(t[1]=(...g)=>n.onClick&&n.onClick(...g)),onTouchend:t[2]||(t[2]=(...g)=>n.onTouchEnd&&n.onTouchEnd(...g)),style:W(e.node.style)},[z((a(),c("button",{type:"button",class:"p-tree-toggler p-link",onClick:t[0]||(t[0]=(...g)=>n.toggle&&n.toggle(...g)),tabindex:"-1","aria-hidden":"true"},[C("span",{class:N(n.toggleIcon)},null,2)])),[[K]]),n.checkboxMode?(a(),c("div",ye,[C("div",{class:N(n.checkboxClass),role:"checkbox"},[C("span",{class:N(n.checkboxIcon)},null,2)],2)])):b("",!0),C("span",{class:N(n.icon)},null,2),C("span",ke,[e.templates[e.node.type]||e.templates.default?(a(),x(de(e.templates[e.node.type]||e.templates.default),{key:0,node:e.node},null,8,["node"])):(a(),c(_,{key:1},[T(M(n.label(e.node)),1)],64))])],38),n.hasChildren&&n.expanded?(a(),c("ul",xe,[(a(!0),c(_,null,I(e.node.children,g=>(a(),x(p,{key:g.key,node:g,templates:e.templates,level:e.level+1,expandedKeys:e.expandedKeys,onNodeToggle:n.onChildNodeToggle,onNodeClick:n.onChildNodeClick,selectionMode:e.selectionMode,selectionKeys:e.selectionKeys,onCheckboxChange:n.propagateUp},null,8,["node","templates","level","expandedKeys","onNodeToggle","onNodeClick","selectionMode","selectionKeys","onCheckboxChange"]))),128))])):b("",!0)],42,ge)}te.render=be;var ne={name:"Tree",emits:["node-expand","node-collapse","update:expandedKeys","update:selectionKeys","node-select","node-unselect"],props:{value:{type:null,default:null},expandedKeys:{type:null,default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},metaKeySelection:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:"pi pi-spinner"},filter:{type:Boolean,default:!1},filterBy:{type:String,default:"label"},filterMode:{type:String,default:"lenient"},filterPlaceholder:{type:String,default:null},filterLocale:{type:String,default:void 0},scrollHeight:{type:String,default:null},level:{type:Number,default:0},"aria-labelledby":{type:String,default:null},"aria-label":{type:String,default:null}},data(){return{d_expandedKeys:this.expandedKeys||{},filterValue:null}},watch:{expandedKeys(l){this.d_expandedKeys=l}},methods:{onNodeToggle(l){const t=l.key;this.d_expandedKeys[t]?(delete this.d_expandedKeys[t],this.$emit("node-collapse",l)):(this.d_expandedKeys[t]=!0,this.$emit("node-expand",l)),this.d_expandedKeys={...this.d_expandedKeys},this.$emit("update:expandedKeys",this.d_expandedKeys)},onNodeClick(l){if(this.selectionMode!=null&&l.node.selectable!==!1){const e=(l.nodeTouched?!1:this.metaKeySelection)?this.handleSelectionWithMetaKey(l):this.handleSelectionWithoutMetaKey(l);this.$emit("update:selectionKeys",e)}},onCheckboxChange(l){this.$emit("update:selectionKeys",l.selectionKeys),l.check?this.$emit("node-select",l.node):this.$emit("node-unselect",l.node)},handleSelectionWithMetaKey(l){const t=l.originalEvent,e=l.node,o=t.metaKey||t.ctrlKey,i=this.isNodeSelected(e);let n;return i&&o?(this.isSingleSelectionMode()?n={}:(n={...this.selectionKeys},delete n[e.key]),this.$emit("node-unselect",e)):(this.isSingleSelectionMode()?n={}:this.isMultipleSelectionMode()&&(n=o?this.selectionKeys?{...this.selectionKeys}:{}:{}),n[e.key]=!0,this.$emit("node-select",e)),n},handleSelectionWithoutMetaKey(l){const t=l.node,e=this.isNodeSelected(t);let o;return this.isSingleSelectionMode()?e?(o={},this.$emit("node-unselect",t)):(o={},o[t.key]=!0,this.$emit("node-select",t)):e?(o={...this.selectionKeys},delete o[t.key],this.$emit("node-unselect",t)):(o=this.selectionKeys?{...this.selectionKeys}:{},o[t.key]=!0,this.$emit("node-select",t)),o},isSingleSelectionMode(){return this.selectionMode==="single"},isMultipleSelectionMode(){return this.selectionMode==="multiple"},isNodeSelected(l){return this.selectionMode&&this.selectionKeys?this.selectionKeys[l.key]===!0:!1},isChecked(l){return this.selectionKeys?this.selectionKeys[l.key]&&this.selectionKeys[l.key].checked:!1},isNodeLeaf(l){return l.leaf===!1?!1:!(l.children&&l.children.length)},onFilterKeydown(l){l.which===13&&l.preventDefault()},findFilteredNodes(l,t){if(l){let e=!1;if(l.children){let o=[...l.children];l.children=[];for(let i of o){let n={...i};this.isFilterMatched(n,t)&&(e=!0,l.children.push(n))}}if(e)return!0}},isFilterMatched(l,{searchFields:t,filterText:e,strict:o}){let i=!1;for(let n of t)String(re.resolveFieldData(l,n)).toLocaleLowerCase(this.filterLocale).indexOf(e)>-1&&(i=!0);return(!i||o&&!this.isNodeLeaf(l))&&(i=this.findFilteredNodes(l,{searchFields:t,filterText:e,strict:o})||i),i}},computed:{containerClass(){return["p-tree p-component",{"p-tree-selectable":this.selectionMode!=null,"p-tree-loading":this.loading,"p-tree-flex-scrollable":this.scrollHeight==="flex"}]},loadingIconClass(){return["p-tree-loading-icon pi-spin",this.loadingIcon]},filteredValue(){let l=[];const t=this.filterBy.split(","),e=this.filterValue.trim().toLocaleLowerCase(this.filterLocale),o=this.filterMode==="strict";for(let i of this.value){let n={...i},p={searchFields:t,filterText:e,strict:o};(o&&(this.findFilteredNodes(n,p)||this.isFilterMatched(n,p))||!o&&(this.isFilterMatched(n,p)||this.findFilteredNodes(n,p)))&&l.push(n)}return l},valueToRender(){return this.filterValue&&this.filterValue.trim().length>0?this.filteredValue:this.value}},components:{TreeNode:te}};const ve={key:0,class:"p-tree-loading-overlay p-component-overlay"},Ce={key:1,class:"p-tree-filter-container"},Ke=["placeholder"],Se=C("span",{class:"p-tree-filter-icon pi pi-search"},null,-1),Ve=["aria-labelledby","aria-label"];function Te(l,t,e,o,i,n){const p=H("TreeNode");return a(),c("div",{class:N(n.containerClass)},[e.loading?(a(),c("div",ve,[C("i",{class:N(n.loadingIconClass)},null,2)])):b("",!0),e.filter?(a(),c("div",Ce,[z(C("input",{"onUpdate:modelValue":t[0]||(t[0]=K=>i.filterValue=K),type:"text",autocomplete:"off",class:"p-tree-filter p-inputtext p-component",placeholder:e.filterPlaceholder,onKeydown:t[1]||(t[1]=(...K)=>n.onFilterKeydown&&n.onFilterKeydown(...K))},null,40,Ke),[[ue,i.filterValue]]),Se])):b("",!0),C("div",{class:"p-tree-wrapper",style:W({maxHeight:e.scrollHeight})},[C("ul",{class:"p-tree-container",role:"tree","aria-labelledby":l.ariaLabelledby,"aria-label":l.ariaLabel},[(a(!0),c(_,null,I(n.valueToRender,(K,g)=>(a(),x(p,{key:K.key,node:K,templates:l.$slots,level:e.level+1,index:g,expandedKeys:i.d_expandedKeys,onNodeToggle:n.onNodeToggle,onNodeClick:n.onNodeClick,selectionMode:e.selectionMode,selectionKeys:e.selectionKeys,onCheckboxChange:n.onCheckboxChange},null,8,["node","templates","level","index","expandedKeys","onNodeToggle","onNodeClick","selectionMode","selectionKeys","onCheckboxChange"]))),128))],8,Ve)],4)],2)}function Ne(l,t){t===void 0&&(t={});var e=t.insertAt;if(!(!l||typeof document>"u")){var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",e==="top"&&o.firstChild?o.insertBefore(i,o.firstChild):o.appendChild(i),i.styleSheet?i.styleSheet.cssText=l:i.appendChild(document.createTextNode(l))}}var _e=`
.p-tree-container {
    margin: 0;
    padding: 0;
    list-style-type: none;
    overflow: auto;
}
.p-treenode-children {
    margin: 0;
    padding: 0;
    list-style-type: none;
}
.p-tree-wrapper {
    overflow: auto;
}
.p-treenode-selectable {
    cursor: pointer;
    user-select: none;
}
.p-tree-toggler {
    cursor: pointer;
    user-select: none;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    position: relative;
    flex-shrink: 0;
}
.p-treenode-leaf > .p-treenode-content .p-tree-toggler {
    visibility: hidden;
}
.p-treenode-content {
    display: flex;
    align-items: center;
}
.p-tree-filter {
    width: 100%;
}
.p-tree-filter-container {
    position: relative;
    display: block;
    width: 100%;
}
.p-tree-filter-icon {
    position: absolute;
    top: 50%;
    margin-top: -0.5rem;
}
.p-tree-loading {
    position: relative;
    min-height: 4rem;
}
.p-tree .p-tree-loading-overlay {
    position: absolute;
    z-index: 1;
    display: flex;
    align-items: center;
    justify-content: center;
}
.p-tree-flex-scrollable {
    display: flex;
    flex: 1;
    height: 100%;
    flex-direction: column;
}
.p-tree-flex-scrollable .p-tree-wrapper {
    flex: 1;
}
`;Ne(_e);ne.render=Te;const we=C("p",null,"blah",-1),Me=U({__name:"RuleTree",props:{value:null,moveRule:{type:Function}},emits:["pickGlobal"],setup(l,{emit:t}){const e=l,o=ce();O(),o.globalRules;const i=p=>{console.log("selected node",p),p.key&&t("pickGlobal",p.key)},n=p=>{console.log("onEnd",p),e.moveRule(p.oldIndex,p.newIndex)};return(p,K)=>(a(),c(_,null,[k(u(ne),{value:e.value,"selection-mode":"single",onNodeSelect:i},null,8,["value"]),k(u(J),{list:e.value,"item-key":"key",tag:"ul",onEnd:n,class:"p-tree-container"},{item:y(({element:g,index:m})=>[(a(),c("li",{class:"draggable p-tree-node",key:g.key},[k(u(me),{label:g.label,icon:"pi pi-bars"},null,8,["label"])]))]),default:y(()=>[we]),_:1},8,["list"])],64))}}),Ee={class:"grid"},Re={class:"col-2"},Ae={class:"col"},Ie={key:1,class:"grid"},Ue={class:"col-12"},se=U({__name:"RuleMatch",props:{modelValue:null},emits:["update:modelValue"],setup(l,{emit:t}){const e=l,o=P(!1),i=j(()=>o?"Match":"Match.. "+Object.keys(e.modelValue).join(",")),n=(m,f)=>{console.log(`updating old key: ${m} to ${f}`);let h=e.modelValue;h[f]=h[m],delete h[m]},p=(m,f,h)=>{console.log("Updating KV",m,f,h);const v=e.modelValue[m];D(v)?v.splice(f,1,h):F(v)&&(e.modelValue[m]=h)},K=(m,f)=>{console.log("Removing KI",m,f);const h=e.modelValue[m];D(h)&&h.splice(f,1)},g=m=>{if(D(e.modelValue[m])){console.log("adding row to array for key ",m);const f=e.modelValue[m];let h=D(f)?f:[f];h.push("");let v=e.modelValue;v[m]=h,t("update:modelValue",v)}else{let f=e.modelValue[m];if(console.log("dict key = ",m),console.log("dict value = ",f),F(f)){let h=[f];h.push(""),e.modelValue,e.modelValue[m]=h}}};return(m,f)=>(a(),x(u(Q),{header:u(i),toggleable:!0,collapsed:o.value,"onUpdate:collapsed":f[0]||(f[0]=h=>o.value=h)},{default:y(()=>[(a(!0),c(_,null,I(e.modelValue,(h,v,$)=>(a(),c("div",Ee,[C("div",Re,[k(u(A),{value:v,type:"text","onUpdate:modelValue":V=>n(v,V)},null,8,["value","onUpdate:modelValue"])]),C("div",Ae,[u(F)(h)?(a(),x(u(A),{key:0,value:h,"onUpdate:modelValue":V=>p(v,-1,V),type:"text"},null,8,["value","onUpdate:modelValue"])):u(D)(h)?(a(),c("div",Ie,[(a(!0),c(_,null,I(h,(V,E)=>(a(),c("div",Ue,[k(u(A),{placeholder:"String",value:V,type:"text","onUpdate:modelValue":R=>p(v,E,R)},null,8,["value","onUpdate:modelValue"]),k(u(G),{icon:"pi pi-times",class:"p-button-rounded p-button-danger p-button-text",onClick:R=>K(v,E)},null,8,["onClick"])]))),256))])):b("",!0),k(u(G),{label:"Add",icon:"pi pi-plus",onClick:V=>g(v)},null,8,["onClick"])])]))),256))]),_:1},8,["header","collapsed"]))}}),De={key:0,style:{"list-style":"none"}},Pe={style:{margin:"5px"}},ie=U({__name:"Rule",props:{rule:null},emits:["save"],setup(l,{emit:t}){const e=l,o=P([{label:"off",value:!1},{label:"on",value:!0}]),i=q({editTitle:!1,showPencil:!1}),n=P([{label:"Match",icon:"pi pi-plus",command:s=>{console.log("X",s),e.rule.match===void 0?e.rule.match={"":""}:e.rule.match[""]=[]}},{label:"Equals",icon:"pi pi-plus"},{label:"Exists",icon:"pi pi-plus",command:()=>{if(e.rule.exists===void 0)e.rule.exists=["changeme"],t("save",e.rule);else if(p(e.rule.exists)){console.log("exists already existed");let s=e.rule.exists;e.rule.exists=[s,"changeme"]}else K(e.rule.exists)&&e.rule.exists.push("changeme")}},{label:"Missing",icon:"pi pi-plus",command:()=>{if(e.rule.missing===void 0)e.rule.missing=["changeme"];else if(p(e.rule.missing)){let s=e.rule.missing;e.rule.missing=[s,"changeme"]}else K(e.rule.missing)&&e.rule.missing.push("changeme")}}]),p=s=>typeof s=="string",K=s=>Array.isArray(s),g=j(()=>{let s=[];return e.rule.all!==void 0&&s.push({all:e.rule.all}),e.rule.equals!==void 0&&s.push({equals:e.rule.equals}),e.rule.missing!==void 0&&s.push({missing:e.rule.missing}),e.rule.exists!==void 0&&s.push({exists:e.rule.exists}),e.rule.match!==void 0&&s.push({match:e.rule.match}),s}),m=s=>{let d={...e.rule,missing:s};console.log("Saving",d),t("save",d)},f=s=>{let d={...e.rule,exists:s};console.log("Saving",d),t("save",d)},h=s=>{let d={...e.rule,match:s};console.log("Saving match",d),t("save",d)},v=()=>{let s={...e.rule};delete s.exists,t("save",s)},$=()=>{let s={...e.rule};delete s.missing,t("save",s)},V=s=>{e.rule.name=s},E=()=>{i.editTitle=i.editTitle===!1},R=s=>{console.log("LOG",s)};return(s,d)=>e.rule?(a(),x(u(B),{key:0},{title:y(()=>[i.editTitle?(a(),x(u(A),{key:1,value:e.rule.name,type:"text","onUpdate:modelValue":V,onFocusout:d[3]||(d[3]=r=>i.editTitle=!1)},null,8,["value"])):(a(),c("div",{key:0,onDblclick:d[0]||(d[0]=r=>i.editTitle=!0),onPointerover:d[1]||(d[1]=r=>i.showPencil=!0),onPointerleave:d[2]||(d[2]=r=>i.showPencil=!1)},[T(" Rule: "+M(e.rule.name)+" ",1),i.showPencil?(a(),c("i",{key:0,class:"pi pi-pencil",onClick:E})):b("",!0)],32))]),subtitle:y(()=>[T(M(e.rule.uuid),1)]),content:y(()=>[u(g).length>0?(a(),c("ul",De,[(a(!0),c(_,null,I(u(g),r=>(a(),c("li",Pe,[r.all!==void 0?(a(),x(u(X),{key:0,"onUpdate:modelValue":[R,S=>r.all=S],modelValue:r.all,options:o.value,"option-label":"label","option-value":"value"},null,8,["modelValue","onUpdate:modelValue","options"])):b("",!0),r.missing!==void 0?(a(),x(Y,{key:1,modelValue:r.missing,"onUpdate:modelValue":[S=>r.missing=S,m],"onRemove:modelValue":$},null,8,["modelValue","onUpdate:modelValue"])):b("",!0),r.exists!==void 0?(a(),x(Z,{key:2,modelValue:r.exists,"onUpdate:modelValue":[S=>r.exists=S,f],"onRemove:modelValue":v},null,8,["modelValue","onUpdate:modelValue"])):b("",!0),r.match!==void 0?(a(),x(se,{key:3,modelValue:r.match,"onUpdate:modelValue":[S=>r.match=S,h]},null,8,["modelValue","onUpdate:modelValue"])):b("",!0)]))),256))])):(a(),x(u(B),{key:1},{title:y(()=>[T(" Add rules")]),content:y(()=>[T(" This rule is missing some selectors ")]),_:1}))]),footer:y(()=>[k(u(le),null,{start:y(()=>[k(u(ee),{label:"add",icon:"pi pi-plus",model:n.value},null,8,["model"])]),_:1})]),_:1})):b("",!0)}}),$e=U({__name:"RulePanel",props:{rule:null},setup(l){const t=l,e=q({editTitle:!1,showPencil:!1});return(o,i)=>(a(),x(u(Q),{collapsed:!0,toggleable:!0},he({default:y(()=>[k(ie,{rule:t.rule},null,8,["rule"])]),_:2},[e.editTitle?{name:"header",fn:y(()=>[k(u(A),{value:t.rule.name,type:"text","onUpdate:modelValue":i[4]||(i[4]=n=>t.rule.name=n),onFocusout:i[5]||(i[5]=n=>e.editTitle=!1)},null,8,["value"])]),key:"1"}:{name:"header",fn:y(()=>[C("div",{onDblclick:i[1]||(i[1]=n=>e.editTitle=!0),onMouseover:i[2]||(i[2]=n=>e.showPencil=!0),onMouseleave:i[3]||(i[3]=n=>e.showPencil=!1)},[T(M(t.rule.name)+" ",1),e.showPencil?(a(),c("i",{key:0,class:"pi pi-pencil",onClick:i[0]||(i[0]=n=>e.editTitle=!e.editTitle)})):b("",!0)],32)]),key:"0"}]),1024))}}),Le=U({__name:"GroupRule",props:{rule:null},emits:["save"],setup(l,{emit:t}){const e=l,o=O(),i=P([{label:"off",value:!1},{label:"on",value:!0}]),n=q({editTitle:!1,showPencil:!1}),p=P([{label:"Add Rule",icon:"pi pi-plus",command:s=>{o.addRuleToGroup(e.rule.uuid)}}]),K=j(()=>{let s=[];return e.rule.all!==void 0&&s.push({all:e.rule.all}),e.rule.equals!==void 0&&s.push({equals:e.rule.equals}),e.rule.missing!==void 0&&s.push({missing:e.rule.missing}),e.rule.exists!==void 0&&s.push({exists:e.rule.exists}),e.rule.match!==void 0&&s.push({match:e.rule.match}),s}),g=(s,d)=>{o.moveRuleInGroup(s,d.oldIndex,d.newIndex)},m=s=>{let d={...e.rule,missing:s};console.log("Saving",d),t("save",d)},f=s=>{let d={...e.rule,exists:s};console.log("Saving",d),t("save",d)},h=s=>{let d={...e.rule,match:s};console.log("Saving match",d),t("save",d)},v=()=>{let s={...e.rule};delete s.exists,t("save",s)},$=()=>{let s={...e.rule};delete s.missing,t("save",s)},V=s=>{e.rule.name=s},E=()=>{n.editTitle=n.editTitle===!1},R=s=>{console.log("LOG",s)};return(s,d)=>e.rule?(a(),x(u(B),{key:0},{title:y(()=>[n.editTitle?(a(),x(u(A),{key:1,value:e.rule.name,type:"text","onUpdate:modelValue":V,onFocusout:d[3]||(d[3]=r=>n.editTitle=!1)},null,8,["value"])):(a(),c("div",{key:0,onDblclick:d[0]||(d[0]=r=>n.editTitle=!0),onPointerover:d[1]||(d[1]=r=>n.showPencil=!0),onPointerleave:d[2]||(d[2]=r=>n.showPencil=!1)},[T(" Group Rule: "+M(e.rule.name)+" ",1),n.showPencil?(a(),c("i",{key:0,class:"pi pi-pencil",onClick:E})):b("",!0)],32))]),subtitle:y(()=>[T(M(e.rule.uuid),1)]),content:y(()=>[C("ul",null,[(a(!0),c(_,null,I(u(K),r=>(a(),c("li",null,[r.all!==void 0?(a(),x(u(X),{key:0,"onUpdate:modelValue":[R,S=>r.all=S],modelValue:r.all,options:i.value,"option-label":"label","option-value":"value"},null,8,["modelValue","onUpdate:modelValue","options"])):b("",!0),r.missing!==void 0?(a(),x(Y,{key:1,modelValue:r.missing,"onUpdate:modelValue":[S=>r.missing=S,m],"onRemove:modelValue":$},null,8,["modelValue","onUpdate:modelValue"])):b("",!0),r.exists!==void 0?(a(),x(Z,{key:2,modelValue:r.exists,"onUpdate:modelValue":[S=>r.exists=S,f],"onRemove:modelValue":v},null,8,["modelValue","onUpdate:modelValue"])):b("",!0),r.match!==void 0?(a(),x(se,{key:3,modelValue:r.match,"onUpdate:modelValue":[S=>r.match=S,h]},null,8,["modelValue","onUpdate:modelValue"])):b("",!0)]))),256))]),k(u(J),{class:"",style:{"list-style":"none"},list:e.rule.rules,"item-key":"uuid",tag:"ul",onEnd:d[4]||(d[4]=r=>g(e.rule.uuid,r))},{header:y(()=>[T(" rule count: "+M(e.rule.rules.length),1)]),item:y(({element:r,index:S})=>[(a(),c("li",{class:"draggable",style:{margin:"5px"},key:r.uuid},[k($e,{rule:r},null,8,["rule"])]))]),_:1},8,["list"])]),footer:y(()=>[k(u(le),null,{start:y(()=>[k(u(ee),{label:"add",icon:"pi pi-plus",model:p.value},null,8,["model"])]),_:1})]),_:1})):b("",!0)}}),Fe={class:"grid"},Ge={class:"col-2"},Be={key:0,class:"col"},Oe={key:1,class:"col"},Je=U({__name:"GroupRulesView",setup(l){const t=O();pe(()=>{t.load([{uuid:L(),name:"1st group",rules:[{uuid:L(),name:"1st rule"}]},{uuid:L(),name:"2nd group",rules:[]},{uuid:L(),name:"3rd group",rules:[]}])});const e=i=>{console.log("global clicked",i),t.setRuleSelected(i,void 0)},o=()=>{t.addGroup()};return(i,n)=>(a(),c("div",Fe,[C("div",Ge,[k(Me,{value:u(t).rules,"move-rule":u(t).moveRule,onPickGlobal:e},null,8,["value","move-rule"]),k(u(fe)),k(u(G),{onClick:o},{default:y(()=>[T("Add Rule")]),_:1})]),u(t).selectedGroupRule?(a(),c("div",Be,[k(Le,{rule:u(t).selectedGroupRule},null,8,["rule"])])):u(t).selectedRule?(a(),c("div",Oe,[k(ie,{rule:u(t).selectedRule},null,8,["rule"])])):b("",!0)]))}});export{Je as default};
