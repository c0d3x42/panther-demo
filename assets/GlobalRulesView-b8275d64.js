import{k as $,o as u,c as f,w as _,A as k,f as e,b as h,d as T,F as j,x as d,X as A,j as c,z as C,Y as z,L as R,$ as le,l as g,e as U,t as B,a0 as L,a1 as te,a2 as G,h as x,M as F,r as se,m as E,a3 as oe,G as ae,H as ne,I as O,a4 as de,a5 as I}from"./index-e442c57d.js";import{s as M,a as P,b as D,c as ie,_ as ue}from"./panel.esm-e2614a2d.js";import{s as K}from"./splitbutton.esm-aca87a08.js";const ce={class:"flex flex-column gap-2"},re={class:"flex-column"},pe={class:"grid p-fluid align-items-center"},me={class:"col-12 md:col-3"},ve={class:"p-inputgroup"},_e=e("span",{class:"p-inputgroup-addon"},"Field",-1),he={class:"col-12 md:col-8"},fe={class:"flex flex-column"},be=$({__name:"RuleMatch",props:{modelValue:null},emits:["update:modelValue"],setup(o,{emit:n}){const t=o,r=(s,a)=>{const l=t.modelValue;l[a]=l[s],delete l[s]},i=(s,a,l)=>{const m=t.modelValue[s];le(m)?m.splice(a,1,l):t.modelValue[s]=l},p=s=>{console.log("appending ",s);const a=t.modelValue[s],l=z(a)?[a]:a;l.push("");let m=t.modelValue;m[s]=l,n("update:modelValue",m)};return(s,a)=>(u(),f(d(A),null,{title:_(()=>[k("Match")]),content:_(()=>[e("div",ce,[(u(!0),h(j,null,T(t.modelValue,(l,m)=>(u(),h("div",re,[e("div",pe,[e("div",me,[e("div",ve,[_e,c(d(C),{value:m,type:"text","onUpdate:modelValue":v=>r(m,v)},null,8,["value","onUpdate:modelValue"])])]),e("div",he,[e("div",fe,[d(z)(l)?(u(),f(d(C),{key:0,class:"flex-row",value:l,type:"text","onUpdate:modelValue":v=>i(m,-1,v)},null,8,["value","onUpdate:modelValue"])):(u(!0),h(j,{key:1},T(l,(v,w)=>(u(),f(d(C),{class:"flex-row",value:v,type:"text","onUpdate:modelValue":b=>i(m,w,b)},null,8,["value","onUpdate:modelValue"]))),256)),c(d(R),{label:"Add new value",class:"p-button-success",onClick:v=>p(m)},null,8,["onClick"])])])])]))),256))])]),_:1}))}}),ge={class:"grid p-fluid align-items-center"},Ve={class:"col-12 md:col-3"},ye={class:"p-inputgroup"},xe=e("span",{class:"p-inputgroup-addon"},"Field",-1),$e={class:"col-12 md:col-4"},Ce={class:"p-inputgroup"},Re=e("span",{class:"p-inputgroup-addon"},"This",-1),we={class:"col-12 md:col-4 align-items-center"},ke={class:"p-inputgroup"},Ue=e("span",{class:"p-inputgroup-addon"},"With",-1),Se=["onClick"],Ae={class:"col-12 md:col-4"},Be=$({__name:"RuleReplace",props:{modelValue:null},emits:["update:modelValue"],setup(o,{emit:n}){const t=o,r=(l,m)=>{t.modelValue[m].field=l},i=(l,m)=>{t.modelValue[m].this=l},p=(l,m)=>{t.modelValue[m].with=l},s=l=>{t.modelValue.splice(l,1)},a=()=>{t.modelValue.push({with:"",this:"",field:""})};return(l,m)=>(u(),f(d(A),null,{title:_(()=>[k("Replacements")]),content:_(()=>[(u(!0),h(j,null,T(t.modelValue,(v,w)=>(u(),h("div",ge,[e("div",Ve,[e("div",ye,[xe,c(d(C),{modelValue:v.field,"onUpdate:modelValue":[b=>v.field=b,b=>r(b,w)],placeholder:"Field from the event",autofocus:""},null,8,["modelValue","onUpdate:modelValue"])])]),e("div",$e,[e("div",Ce,[Re,c(d(C),{modelValue:v.this,"onUpdate:modelValue":[b=>v.this=b,b=>i(b,w)],placeholder:"Find this...",autofocus:""},null,8,["modelValue","onUpdate:modelValue"])])]),e("div",we,[e("div",ke,[Ue,c(d(C),{modelValue:v.with,"onUpdate:modelValue":[b=>v.with=b,b=>p(b,w)],placeholder:"Replace with...",autofocus:""},null,8,["modelValue","onUpdate:modelValue"])])]),e("i",{class:"pi pi-times",style:{color:"var(--red-400)"},onClick:b=>s(w)},null,8,Se)]))),256)),e("div",Ae,[c(d(R),{label:"Add",onClick:a})])]),_:1}))}}),Ie={class:"grid p-fluid align-items-center"},Te={class:"col-12 md:col-4"},je={class:"p-inputgroup"},Ge=e("span",{class:"p-inputgroup-addon"},"discard event?",-1),De=$({__name:"RuleDiscard",props:{modelValue:{type:Boolean}},emits:["update:modelValue","remove"],setup(o,{emit:n}){const t=o,r=g([{label:"Keep",value:!1},{label:"Discard",value:!0}]),i=s=>{n("update:modelValue",s)},p=()=>{n("remove")};return(s,a)=>(u(),h("div",Ie,[e("div",Te,[e("div",je,[Ge,c(d(M),{class:"rule-discard mr-3",modelValue:t.modelValue,"onUpdate:modelValue":[a[0]||(a[0]=l=>t.modelValue=l),i],options:r.value,"option-label":"label","option-value":"value"},{option:_(l=>[e("div",{class:U(`rule-discard-${l.option.value}`)},B(l.option.label),3)]),_:1},8,["modelValue","options"]),e("i",{class:"pi pi-times",style:{color:"var(--red-400)"},onClick:p})])])]))}}),Fe={class:"grid p-fluid align-items-center"},Pe={class:"col-12 md:col-3"},Me={class:"p-inputgroup"},Ne=e("span",{class:"p-inputgroup-addon"},"Field",-1),ze={class:"col-12 md:col-4"},Ee={class:"p-inputgroup"},Ke=e("span",{class:"p-inputgroup-addon"},"To",-1),Le=$({__name:"RuleSet",props:{modelValue:null},setup(o){const n=o,t=L(()=>Object.keys(n.modelValue).map(s=>({key:s,value:n.modelValue[s]}))),r=(s,a)=>{const l=n.modelValue[s];delete n.modelValue[s],n.modelValue[a]=l},i=(s,a)=>{n.modelValue[s]=a},p=()=>{console.log("adding value"),n.modelValue.hhh="xxxx"};return(s,a)=>(u(),f(d(A),null,{title:_(()=>[k("Set")]),content:_(()=>[(u(!0),h(j,null,T(d(t),(l,m)=>(u(),h("div",Fe,[e("div",Pe,[e("div",Me,[Ne,c(d(C),{class:U(`idx-${m}`),value:l.key,type:"text","onUpdate:modelValue":v=>r(l.key,v),placeholder:"Field in event"},null,8,["class","value","onUpdate:modelValue"])])]),e("div",ze,[e("div",Ee,[Ke,c(d(C),{value:l.value,type:"text","onUpdate:modelValue":v=>i(l.key,v),placeholder:"Set with this..."},null,8,["value","onUpdate:modelValue"])])])]))),256)),c(d(R),{label:"Add",onClick:p})]),_:1}))}}),Oe={class:"grid p-fluid align-items-center"},He={class:"col-12 md:col-4"},We={class:"p-inputgroup"},Qe=e("span",{class:"p-inputgroup-addon"},"stop processing?",-1),Xe=$({__name:"RuleStop",props:{modelValue:{type:Boolean}},emits:["update:modelValue","remove"],setup(o,{emit:n}){const t=o,r=g([{label:"UnStop",value:!1},{label:"Stop",value:!0}]),i=s=>{n("update:modelValue",s)},p=()=>{n("remove")};return(s,a)=>(u(),h("div",Oe,[e("div",He,[e("div",We,[Qe,c(d(M),{class:"rule-discard mr-3",modelValue:t.modelValue,"onUpdate:modelValue":[a[0]||(a[0]=l=>t.modelValue=l),i],options:r.value,"option-label":"label","option-value":"value"},{option:_(l=>[e("div",{class:U(`rule-discard-${l.option.value}`)},B(l.option.label),3)]),_:1},8,["modelValue","options"]),e("i",{class:"pi pi-times",style:{color:"var(--red-400)"},onClick:p})])])]))}}),Ye={class:"grid p-fluid align-items-center"},qe={class:"col-12 md:col-4"},Je={class:"p-inputgroup"},Ze=e("span",{class:"p-inputgroup-addon"},"stop after this group?",-1),el=$({__name:"RuleStopRule",props:{modelValue:{type:Boolean}},emits:["update:modelValue","remove"],setup(o,{emit:n}){const t=o,r=g([{label:"UnStop",value:!1},{label:"Stop",value:!0}]),i=s=>{n("update:modelValue",s)},p=()=>{n("remove")};return(s,a)=>(u(),h("div",Ye,[e("div",qe,[e("div",Je,[Ze,c(d(M),{class:"rule-discard mr-3",modelValue:t.modelValue,"onUpdate:modelValue":[a[0]||(a[0]=l=>t.modelValue=l),i],options:r.value,"option-label":"label","option-value":"value"},{option:_(l=>[e("div",{class:U(`rule-discard-${l.option.value}`)},B(l.option.label),3)]),_:1},8,["modelValue","options"]),e("i",{class:"pi pi-times",style:{color:"var(--red-400)"},onClick:p})])])]))}}),ll={class:"flex-column mx-4"},tl=e("div",{class:"pb-2"},"Select events where...",-1),sl=e("div",{class:"pb-2"},"Then...",-1),ol={class:"flex justify-content-end"},al=$({__name:"RuleEdit",props:{rule:null},emits:["update:modelValue","cancel"],setup(o,{emit:n}){const t=o,r=te(),i=g(t.rule.set),p=L(()=>i.value!==void 0?Boolean(Object.length):!1),s=g(t.rule.discard),a=g(t.rule.replace),l=g(t.rule.stop),m=g(t.rule.stop_rule),v=g(t.rule.match),w=G(),b=g([{label:"Match",command:()=>{v.value===void 0?v.value={"":""}:v.value[""]=[""]}}]);g([{name:"After Group",value:!0},{name:"Unstop Group",value:!1}]);const Q=()=>{var V;let S=((V=a.value)==null?void 0:V.filter(y=>y.field))||void 0;n("update:modelValue",{...t.rule,discard:s.value,stop:l.value,replace:S,match:v.value}),r.add({severity:"success",summary:"Rule updated",detail:"Message Content",group:"tr",life:3e3})},X=()=>{s.value=t.rule.discard,a.value=t.rule.replace,l.value=t.rule.stop,v.value=t.rule.match,n("cancel"),r.add({severity:"info",summary:"Rule cancelled",detail:"Message Content",group:"tr",life:3e3})},Y=()=>{w.deleteRule(t.rule.uuid),r.add({severity:"warn",summary:"Rule Deleted",detail:"Message Content",group:"tr",life:3e3})},q=()=>{s.value=void 0},J=()=>{l.value=void 0},Z=()=>{m.value=void 0},ee=g([{label:"discard",disabled:()=>s.value===!0,command:()=>{s.value=!0}},{label:"replace",command:()=>{const S={field:"",this:"",with:""};Array.isArray(a.value)?a.value.push(S):a.value=[S]}},{label:"set",disabled:()=>p.value,command:()=>{i.value===void 0?i.value={"":""}:i.value[""]=""}},{label:"stop",command:()=>{l.value=!0}},{label:"Stop After Group",command:()=>{m.value=!0}}]);return(S,V)=>(u(),h("div",ll,[tl,c(d(K),{label:"Add Selector",model:b.value,class:"p-button-text p-button-sm"},null,8,["model"]),v.value?(u(),f(be,{key:0,"model-value":v.value},null,8,["model-value"])):x("",!0),c(d(P)),sl,c(d(K),{label:"Add Action",model:ee.value,class:"p-button-text p-button-sm"},null,8,["model"]),s.value!==void 0?(u(),f(De,{key:1,modelValue:s.value,"onUpdate:modelValue":V[0]||(V[0]=y=>s.value=y),onRemove:q},null,8,["modelValue"])):x("",!0),l.value!==void 0?(u(),f(Xe,{key:2,modelValue:l.value,"onUpdate:modelValue":V[1]||(V[1]=y=>l.value=y),onRemove:J},null,8,["modelValue"])):x("",!0),m.value!==void 0?(u(),f(el,{key:3,modelValue:m.value,"onUpdate:modelValue":V[2]||(V[2]=y=>m.value=y),onRemove:Z},null,8,["modelValue"])):x("",!0),i.value!==void 0?(u(),f(Le,{key:4,modelValue:i.value,"onUpdate:modelValue":V[3]||(V[3]=y=>i.value=y)},null,8,["modelValue"])):x("",!0),a.value!==void 0?(u(),f(Be,{key:5,modelValue:a.value,"onUpdate:modelValue":V[4]||(V[4]=y=>a.value=y)},null,8,["modelValue"])):x("",!0),c(d(P)),e("div",ol,[c(d(R),{class:"mx-2 p-button-success",icon:"pi pi-check",label:"Update","icon-pos":"right",onClick:Q}),c(d(R),{class:"mx-2 p-button-info",icon:"pi pi-times",label:"Cancel","icon-pos":"right",onClick:X}),c(d(R),{class:"mx-2 p-button-danger",icon:"pi pi-trash",label:"Delete","icon-pos":"right",onClick:Y})])]))}});var H={name:"Badge",props:{value:null,severity:null,size:null},computed:{containerClass(){return this.$slots.default?"p-overlay-badge":this.badgeClass},badgeClass(){return["p-badge p-component",{"p-badge-no-gutter":this.value&&String(this.value).length===1,"p-badge-dot":!this.value&&!this.$slots.default,"p-badge-lg":this.size==="large","p-badge-xl":this.size==="xlarge","p-badge-info":this.severity==="info","p-badge-success":this.severity==="success","p-badge-warning":this.severity==="warning","p-badge-danger":this.severity==="danger"}]}}};function nl(o,n,t,r,i,p){return u(),h("span",{class:U(p.badgeClass)},[F(o.$slots,"default",{},()=>[k(B(t.value),1)])],2)}H.render=nl;var W={name:"Inplace",emits:["open","close","update:active"],props:{closable:{type:Boolean,default:!1},active:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},closeIcon:{type:String,default:"pi pi-times"},displayProps:{type:null,default:null},closeButtonProps:{type:null,default:null}},data(){return{d_active:this.active}},watch:{active(o){this.d_active=o}},methods:{open(o){this.disabled||(this.$emit("open",o),this.d_active=!0,this.$emit("update:active",!0))},close(o){this.$emit("close",o),this.d_active=!1,this.$emit("update:active",!1),setTimeout(()=>{this.$refs.display.focus()},0)}},computed:{containerClass(){return["p-inplace p-component",{"p-inplace-closable":this.closable}]},displayClass(){return["p-inplace-display",{"p-disabled":this.disabled}]},closeAriaLabel(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.close:void 0}},components:{IPButton:R}};const dl=["tabindex"],il={key:1,class:"p-inplace-content"};function ul(o,n,t,r,i,p){const s=se("IPButton");return u(),h("div",{class:U(p.containerClass),"aria-live":"polite"},[i.d_active?(u(),h("div",il,[F(o.$slots,"content"),t.closable?(u(),f(s,E({key:0,icon:t.closeIcon,"aria-label":p.closeAriaLabel,onClick:p.close},t.closeButtonProps),null,16,["icon","aria-label","onClick"])):x("",!0)])):(u(),h("div",E({key:0,ref:"display",class:p.displayClass,tabindex:o.$attrs.tabindex||"0",role:"button",onClick:n[0]||(n[0]=(...a)=>p.open&&p.open(...a)),onKeydown:n[1]||(n[1]=oe((...a)=>p.open&&p.open(...a),["enter"]))},t.displayProps),[F(o.$slots,"display")],16,dl))],2)}function cl(o,n){n===void 0&&(n={});var t=n.insertAt;if(!(!o||typeof document>"u")){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",t==="top"&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=o:i.appendChild(document.createTextNode(o))}}var rl=`
.p-inplace .p-inplace-display {
    display: inline;
    cursor: pointer;
}
.p-inplace .p-inplace-content {
    display: inline;
}
.p-fluid .p-inplace.p-inplace-closable .p-inplace-content {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
}
.p-fluid .p-inplace.p-inplace-closable .p-inplace-content > .p-inputtext {
    -webkit-box-flex: 1;
        -ms-flex: 1 1 auto;
            flex: 1 1 auto;
    width: 1%;
}
`;cl(rl);W.render=ul;const N=o=>(ae("data-v-fc6d37d8"),o=o(),ne(),o),pl=N(()=>e("i",{class:"pi pi-pencil pr-1"},null,-1)),ml={class:"grid col mr-4"},vl={class:"flex col justify-content-between flex-wrap card-container purple-container"},_l={class:"flex flex-column align-items-start justify-content-center font-bold text-white border-round"},hl={class:"flex flex-row align-items-center"},fl=N(()=>e("i",{class:"pi pi-bars mr-3 rule-sort-handle"},null,-1)),bl={key:0,class:"flex align-items-center flex-column sm:flex-row gap-2 mt-2 ml-4"},gl={class:"flex align-items-center justify-content-center font-bold text-white border-round"},Vl={class:"flex flex-column"},yl={class:"flex"},xl=N(()=>e("div",{class:"flex text-xs"},"UUID:",-1)),$l=$({__name:"RulePanelAlt",props:{rule:null,index:null},setup(o){const n=o,t=G(),r=g(!0),i=s=>{t.save(s)},p=()=>{t.save(n.rule)};return(s,a)=>(u(),f(d(ie),{collapsed:r.value,"onUpdate:collapsed":a[1]||(a[1]=l=>r.value=l),toggleable:!0},{icons:_(()=>[pl]),header:_(()=>[e("div",ml,[e("div",vl,[e("div",_l,[e("div",hl,[fl,c(d(W),{closable:!0,class:"text-2xl font-bold rule-name"},{display:_(()=>[k(B(o.rule.name),1)]),content:_(()=>[c(d(C),{modelValue:o.rule.name,"onUpdate:modelValue":a[0]||(a[0]=l=>o.rule.name=l),autofocus:""},null,8,["modelValue"])]),_:1})]),r.value?(u(),h("div",bl,[o.rule.discard===!0?(u(),f(d(D),{key:0,class:"ev-discard text-xs",icon:"pi pi-circle-fill",label:"discard"})):x("",!0),o.rule.stop===!0?(u(),f(d(D),{key:1,class:"ev-stop text-xs",icon:"pi pi-circle-fill",label:"stop"})):x("",!0),Array.isArray(o.rule.replace)?(u(),f(d(D),{key:2,class:"ev-replace text-xs",icon:"pi pi-circle-fill",label:"replace"})):x("",!0)])):x("",!0)]),e("div",gl,[e("div",Vl,[e("div",yl,[k(" Rule Hits: "),c(d(H),{class:"ml-1",value:"3",severity:"danger"})]),xl])])])])]),default:_(()=>[c(al,{rule:n.rule,"onUpdate:modelValue":i,onCancel:p},null,8,["rule"])]),_:1},8,["collapsed"]))}});const Cl=O($l,[["__scopeId","data-v-fc6d37d8"]]),Rl=$({__name:"GlobalRules",setup(o){const n=G(),t={handle:".rule-sort-handle"};return g(!0),de(()=>{n.loadGlobalRules([I("global 1"),I("global 2"),I("global 3"),I("global 4")])}),(r,i)=>(u(),f(d(ue),{list:d(n).globalOrderedRules,tag:"ul","item-key":"uuid",class:"ev-rules",options:t},{item:_(({element:p,index:s})=>[(u(),h("li",{class:"draggable p-tree-node pb-3",key:p.uuid},[c(Cl,{rule:p,index:s},null,8,["rule","index"])]))]),_:1},8,["list"]))}});const wl=O(Rl,[["__scopeId","data-v-b87d621e"]]),kl={class:"mx-8"},Ul=e("div",{class:"flex justify-content-between align-content-center"},[e("h1",null,"Global Rules"),e("div",null,"Total Rules: xx Rule hits: yy")],-1),Sl={class:"grid relative"},Al={class:"col-4 align-content-end"},Bl={class:"flex flex-column justify-content-end"},Gl=$({__name:"GlobalRulesView",setup(o){const n=G(),t=()=>{n.addRule("new rule")};return(r,i)=>(u(),h("div",kl,[Ul,c(d(P)),e("div",Sl,[c(wl,{class:"col-8"}),e("div",Al,[e("div",Bl,[c(d(A),{style:{width:"24rem"},class:"border-1 my-3 border-round"},{title:_(()=>[k("Quick Actions ")]),content:_(()=>[c(d(R),{label:"Create Rule",class:"p-button-success",onClick:t})]),_:1}),c(d(A),{style:{width:"24rem"},class:"border-1 my-3 border-round"},{title:_(()=>[k("Search rules")]),content:_(()=>[c(d(R),{label:"Search Rule"})]),_:1})])])])]))}});export{Gl as default};
